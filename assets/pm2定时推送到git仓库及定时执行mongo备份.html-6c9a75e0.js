import{_ as i}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as p,c,a as n,b as a,d as e,e as t}from"./app-c13b3cb2.js";const d={},l=n("h2",{id:"安装pm2",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#安装pm2","aria-hidden":"true"},"#"),a(" 安装pm2")],-1),r=n("h3",{id:"安装node",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#安装node","aria-hidden":"true"},"#"),a(" 安装node")],-1),u={href:"https://nodejs.org/dist/v16.15.0/node-v16.15.0-x64.msi",target:"_blank",rel:"noopener noreferrer"},m=n("br",null,null,-1),v=t(`<h4 id="安装pm2-1" tabindex="-1"><a class="header-anchor" href="#安装pm2-1" aria-hidden="true">#</a> 安装pm2</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>npm install -g pm2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="编写git推送py脚本" tabindex="-1"><a class="header-anchor" href="#编写git推送py脚本" aria-hidden="true">#</a> 编写git推送py脚本</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token keyword">import</span> time

<span class="token comment"># 获取当前时间</span>
now_time <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">callback</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>result<span class="token punctuation">)</span>


<span class="token comment"># add the file</span>
add <span class="token operator">=</span> <span class="token string">&quot;git add .&quot;</span>
<span class="token comment"># commit the file</span>
commit <span class="token operator">=</span> <span class="token string">&quot;git commit -m &#39;auto commit: {}&#39;&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>now_time<span class="token punctuation">)</span>
<span class="token comment"># push the file</span>
push <span class="token operator">=</span> <span class="token string">&quot;git push origin master&quot;</span>
callback<span class="token punctuation">(</span>add<span class="token punctuation">)</span>
callback<span class="token punctuation">(</span>commit<span class="token punctuation">)</span>
callback<span class="token punctuation">(</span>push<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pm2执行脚本并定时推送" tabindex="-1"><a class="header-anchor" href="#pm2执行脚本并定时推送" aria-hidden="true">#</a> pm2执行脚本并定时推送</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pm2 start XXX.py --restart-delay 86400000 （1天=86400000ms）
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="mogno每天自动全备份" tabindex="-1"><a class="header-anchor" href="#mogno每天自动全备份" aria-hidden="true">#</a> mogno每天自动全备份</h2><h3 id="安装node、pm2" tabindex="-1"><a class="header-anchor" href="#安装node、pm2" aria-hidden="true">#</a> 安装node、pm2</h3><p>同上</p><h3 id="安装mongotools" tabindex="-1"><a class="header-anchor" href="#安装mongotools" aria-hidden="true">#</a> 安装mongoTools</h3>`,10),h={href:"https://fastdl.mongodb.org/tools/db/mongodb-database-tools-windows-x86_64-100.5.2.zip",target:"_blank",rel:"noopener noreferrer"},k=n("br",null,null,-1),b=t(`<h3 id="编写备份脚本" tabindex="-1"><a class="header-anchor" href="#编写备份脚本" aria-hidden="true">#</a> 编写备份脚本</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token keyword">import</span> time


<span class="token comment"># 获取当前日期</span>
<span class="token keyword">def</span> <span class="token function">get_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    date <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&#39;%Y%m%d&#39;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> date


os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">&#39;mongodump -o F:\\\\db_back\\\\back\\\\{}&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>get_date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="pm2定时执行" tabindex="-1"><a class="header-anchor" href="#pm2定时执行" aria-hidden="true">#</a> pm2定时执行</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pm2 start XXX.py --restart-delay 86400000 （1天=86400000ms）
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="pm2保存" tabindex="-1"><a class="header-anchor" href="#pm2保存" aria-hidden="true">#</a> pm2保存</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pm2 save
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,6);function g(_,x){const s=o("ExternalLinkIcon");return p(),c("div",null,[l,r,n("p",null,[n("a",u,[a("https://nodejs.org/dist/v16.15.0/node-v16.15.0-x64.msi"),e(s)]),m,a(" 一直next即可")]),v,n("p",null,[n("a",h,[a("https://fastdl.mongodb.org/tools/db/mongodb-database-tools-windows-x86_64-100.5.2.zip"),e(s)]),k,a(" 设置环境变量")]),b])}const w=i(d,[["render",g],["__file","pm2定时推送到git仓库及定时执行mongo备份.html.vue"]]);export{w as default};
